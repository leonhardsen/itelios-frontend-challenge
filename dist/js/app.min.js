/* Recommendation-Widget by Leonardo Ruiz on 18/08/2017 02:37:40 */

function createDots(a,b){carousel_nav.innerHTML="";var c=Math.ceil(a/b),d=1;for(i=0;i<c;i++)dot_element=document.createElement("button"),dot_element.classList.add("recommendations-carousel-dot"),0==i&&dot_element.classList.add("recommendations-carousel-dot-active"),dot_element.setAttribute("id","recommendations-carousel-dot-"+d),d+=b,carousel_nav.appendChild(dot_element);addListenerDots()}function addListenerDots(){for(var a=document.querySelectorAll(".recommendations-carousel-dot"),b=0;b<a.length;b++)a[b].addEventListener("click",carouselNav)}function carouselNav(){var a=this.id;a=a.replace("recommendations-carousel-dot-",""),document.querySelector(".recommendations-carousel-dot-active").classList.remove("recommendations-carousel-dot-active"),this.classList.add("recommendations-carousel-dot-active"),slideTo(a)}function slideTo(a){items_width=carousel_inner.children[0].offsetWidth,carousel_inner.style.marginLeft="-"+items_width*(a-1)+"px"}function defineContainerWidth(a,b){for(carousel_inner.style.width=b*a.length+"px",i=0;i<a.length;i++)a[i].style.width=b+"px"}function carouselInitialize(a,b,c){defineContainerWidth(b,a),createDots(b.length,c),slideTo(1)}function createProduct(a){return created_product=document.createElement("div"),created_product.classList.add("product"),created_product_img=document.createElement("img"),created_product_img.setAttribute("src",a.imageName),created_product_img.setAttribute("onerror",'javascript:this.src="dist/img/default.jpg"'),created_product.appendChild(created_product_img),created_product_p_name=document.createElement("p"),created_product_p_name.classList.add("name"),a.name.length>80?product_name=a.name.substr(0,80)+"...":product_name=a.name,created_product_p_name.textContent=product_name,created_product.appendChild(created_product_p_name),created_product_p_price=document.createElement("p"),created_product_p_price.classList.add("price"),created_product_p_price.innerHTML="Por: <span>"+a.price+"</span>",created_product.appendChild(created_product_p_price),created_product_p_conditions=document.createElement("p"),created_product_p_conditions.classList.add("conditions"),created_product_p_conditions.innerHTML="ou até <span>"+a.productInfo.paymentConditions.replace("ou até ","").replace(" sem juros","")+"</span> sem juros",created_product.appendChild(created_product_p_conditions),created_product_button=document.createElement("button"),created_product_button.classList.add("cart-button"),created_product_button_span=document.createElement("span"),created_product_button_span.textContent="adicionar ao carrinho",created_product_button.appendChild(created_product_button_span),created_product_button_icon=document.createElement("i"),created_product_button_icon.classList.add("material-icons"),created_product_button_icon.textContent="add_shopping_cart",created_product_button.appendChild(created_product_button_icon),created_product.appendChild(created_product_button),created_product.addEventListener("click",addClickClass),created_product}function addClickClass(){var a=document.querySelector(".clicked");a&&a.classList.remove("clicked"),this.classList.add("clicked")}function request(){var a=new XMLHttpRequest;a.open("GET","json/products.json"),a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status){var b=JSON.parse(a.responseText),c=b[0].data.item,d=b[0].data.recommendation;visited_product=createProduct(c),document.querySelector(".visited").appendChild(visited_product),d.map(function(a){product=createProduct(a),carousel_inner.appendChild(product)});var e=carousel_inner.children,f=e[0].offsetWidth;window.innerWidth<620?visible_items=1:window.innerWidth<1040?visible_items=2:visible_items=3,carouselInitialize(f,e,visible_items)}else console.log("Erro ao obter os produtos.")},a.send()}var carousel=document.querySelector(".recommendations-carousel"),carousel_inner=carousel.querySelector(".recommendations-carousel-inner"),carousel_nav=carousel.querySelector(".recommendations-carousel-nav");window.onresize=function(){var a=carousel_inner.children;if(0!=a.length)if(window.innerWidth<620){var b=carousel.offsetWidth/1;carouselInitialize(b,a,1)}else if(window.innerWidth<1040){var b=carousel.offsetWidth/2;carouselInitialize(b,a,2)}else{var b=carousel.offsetWidth/3;carouselInitialize(b,a,3)}},request(),window.onresize();